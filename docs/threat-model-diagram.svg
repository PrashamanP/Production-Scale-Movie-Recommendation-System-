<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550" width="900" height="550">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
    <marker id="arrow-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#c92a2a"/>
    </marker>
  </defs>
  
  <rect width="900" height="550" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="450" y="25" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">STRIDE Threat Model - Movie Recommendation System</text>
  
  <!-- External Boundary -->
  <rect x="20" y="45" width="180" height="100" rx="5" fill="#fff3e0" stroke="#ff9800" stroke-width="2"/>
  <text x="110" y="65" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#e65100">External Boundary</text>
  <rect x="35" y="80" width="70" height="30" rx="3" fill="#fff" stroke="#666"/>
  <text x="70" y="100" text-anchor="middle" font-family="Arial" font-size="10">Users</text>
  <rect x="115" y="80" width="70" height="30" rx="3" fill="#ff6b6b" stroke="#c92a2a" stroke-width="2"/>
  <text x="150" y="100" text-anchor="middle" font-family="Arial" font-size="10" fill="#fff" font-weight="bold">Adversary</text>
  
  <!-- DMZ -->
  <rect x="230" y="70" width="120" height="50" rx="5" fill="#e3f2fd" stroke="#1976d2" stroke-width="2"/>
  <text x="290" y="88" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="#0d47a1">DMZ</text>
  <rect x="245" y="95" width="90" height="20" rx="3" fill="#74c0fc" stroke="#1971c2"/>
  <text x="290" y="109" text-anchor="middle" font-family="Arial" font-size="9">nginx Proxy</text>
  
  <!-- Kubernetes Cluster -->
  <rect x="230" y="150" width="350" height="200" rx="5" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
  <text x="405" y="170" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#2e7d32">Kubernetes Cluster</text>
  <rect x="245" y="185" width="90" height="25" rx="3" fill="#c8e6c9" stroke="#388e3c"/>
  <text x="290" y="202" text-anchor="middle" font-family="Arial" font-size="9">K8s Service</text>
  
  <!-- Pods -->
  <rect x="245" y="225" width="250" height="70" rx="3" fill="#f1f8e9" stroke="#689f38" stroke-dasharray="4,2"/>
  <text x="370" y="242" text-anchor="middle" font-family="Arial" font-size="9" fill="#33691e">Flask Pods (x3)</text>
  <rect x="255" y="252" width="70" height="35" rx="3" fill="#fff" stroke="#666"/>
  <text x="290" y="270" text-anchor="middle" font-family="Arial" font-size="8">Pod 1</text>
  <text x="290" y="280" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">ALS/PopGen</text>
  <rect x="335" y="252" width="70" height="35" rx="3" fill="#fff" stroke="#666"/>
  <text x="370" y="270" text-anchor="middle" font-family="Arial" font-size="8">Pod 2</text>
  <text x="370" y="280" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">ALS/PopGen</text>
  <rect x="415" y="252" width="70" height="35" rx="3" fill="#fff" stroke="#666"/>
  <text x="450" y="270" text-anchor="middle" font-family="Arial" font-size="8">Pod 3</text>
  <text x="450" y="280" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">ALS/PopGen</text>
  
  <!-- Model Artifacts -->
  <ellipse cx="520" cy="320" rx="50" ry="22" fill="#e1f5fe" stroke="#0288d1"/>
  <text x="520" y="318" text-anchor="middle" font-family="Arial" font-size="8">Model Artifacts</text>
  <text x="520" y="328" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">/models/latest/</text>
  
  <!-- Data Pipeline -->
  <rect x="610" y="150" width="200" height="200" rx="5" fill="#fff8e1" stroke="#ffc107" stroke-width="2"/>
  <text x="710" y="170" text-anchor="middle" font-family="Arial" font-size="11" font-weight="bold" fill="#f57f17">Data Pipeline</text>
  <ellipse cx="710" cy="210" rx="55" ry="22" fill="#ffd43b" stroke="#fab005" stroke-width="2"/>
  <text x="710" y="208" text-anchor="middle" font-family="Arial" font-size="9" font-weight="bold">Kafka</text>
  <text x="710" y="220" text-anchor="middle" font-family="Arial" font-size="7">movielog13</text>
  <rect x="655" y="250" width="110" height="35" rx="3" fill="#fff" stroke="#666"/>
  <text x="710" y="267" text-anchor="middle" font-family="Arial" font-size="8">Retrain Pipeline</text>
  <text x="710" y="278" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">(Jenkins 3-day)</text>
  <rect x="655" y="300" width="110" height="35" rx="3" fill="#ffd43b" stroke="#fab005" stroke-width="2"/>
  <text x="710" y="317" text-anchor="middle" font-family="Arial" font-size="8" font-weight="bold">Data Validation</text>
  <text x="710" y="328" text-anchor="middle" font-family="Arial" font-size="7" fill="#666">(schema only)</text>
  
  <!-- Monitoring -->
  <rect x="20" y="380" width="160" height="90" rx="5" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2"/>
  <text x="100" y="400" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold" fill="#6a1b9a">Monitoring</text>
  <rect x="35" y="415" width="60" height="25" rx="3" fill="#fff" stroke="#666"/>
  <text x="65" y="432" text-anchor="middle" font-family="Arial" font-size="8">Prometheus</text>
  <rect x="105" y="415" width="60" height="25" rx="3" fill="#fff" stroke="#666"/>
  <text x="135" y="432" text-anchor="middle" font-family="Arial" font-size="8">Grafana</text>
  
  <!-- Arrows -->
  <line x1="70" y1="110" x2="70" y2="130" stroke="#333" stroke-width="1.5"/>
  <line x1="70" y1="130" x2="230" y2="95" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="140" y="105" font-family="Arial" font-size="7">GET /recommend</text>
  
  <line x1="290" y1="120" x2="290" y2="185" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="290" y1="210" x2="290" y2="252" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="450" y1="287" x2="480" y2="305" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <line x1="710" y1="232" x2="710" y2="250" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="710" y1="285" x2="710" y2="300" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="655" y1="317" x2="570" y2="317" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="610" y="310" font-family="Arial" font-size="7">Update symlink</text>
  
  <line x1="290" y1="295" x2="100" y2="380" stroke="#333" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="170" y="350" font-family="Arial" font-size="7">/metrics</text>
  
  <!-- Attack Vectors -->
  <path d="M 150 110 Q 200 140 230 105" fill="none" stroke="#c92a2a" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrow-red)"/>
  <text x="195" y="138" font-family="Arial" font-size="8" fill="#c92a2a" font-weight="bold">T1: Flood</text>
  
  <path d="M 185 95 Q 400 40 660 200" fill="none" stroke="#c92a2a" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrow-red)"/>
  <text x="420" y="60" font-family="Arial" font-size="8" fill="#c92a2a" font-weight="bold">T2: Inject Malicious Events</text>
  
  <!-- Legend -->
  <rect x="620" y="400" width="260" height="100" rx="5" fill="#fff" stroke="#ccc"/>
  <text x="750" y="420" text-anchor="middle" font-family="Arial" font-size="10" font-weight="bold">Legend</text>
  <line x1="635" y1="440" x2="685" y2="440" stroke="#333" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="695" y="443" font-family="Arial" font-size="8">Data Flow</text>
  <line x1="635" y1="460" x2="685" y2="460" stroke="#c92a2a" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrow-red)"/>
  <text x="695" y="463" font-family="Arial" font-size="8" fill="#c92a2a">Attack Vector</text>
  <rect x="635" y="475" width="20" height="12" fill="#ffd43b" stroke="#fab005"/>
  <text x="665" y="485" font-family="Arial" font-size="8">Vulnerability Point</text>
</svg>